/***
* SimplBox - v1.0.0 - 2014.08.04
* Author: (c) Dendrochronology - @Dendrochronolo - http://genert.laal.ee/
* Available for use under the MIT License.
***/
!function(e,t,n){"use strict";function r(e,n){var a=this;i=t.getElementsByTagName("body")[0],a.m_Elements=e,a.m_UserOptions=n||{},a.m_Options={},a.m_CurrentTargetElements=m,a.m_CurrentTargetElementsLength=m,a.m_CurrentTargetNumber=m,a.m_CurrentImageElement=m,a.m_InProgress=m,a.m_InstalledImageBox=m,a.m_Alt=m,a.m_AnimateDone=m;(function(){for(var e in r.options)a.m_UserOptions.hasOwnProperty(e)?a.m_Options[e]=a.m_UserOptions[e]:a.m_Options[e]=r.options[e]})()}var a=t.documentElement,i=t.getElementsByTagName("body")[0],m=!1,o="attachEvent",s="addEventListener",l=s in t;r.prototype={init:function(){var e=this;e.API_AddEvent=e.addEvent,e.API_RemoveImageElement=e.removeImageElement,e.checkBrowser(),e.addEvents()},checkBrowser:function(){var t=this,n="ontouchstart"in e||e.navigator.msMaxTouchPoints||navigator.maxTouchPoints||m,r=n&&(e.navigator.pointerEnabled||e.navigator.msPointerEnabled);t.browser={isHardwareAccelerated:"undefined"!==t.getcss3prop("transition")?!0:m,isTouch:n,hasPointers:r}},addEvents:function(){for(var n=this,r=0;r<n.m_Elements.length;r++)!function(t){n.addEvent(n.m_Elements[t],n.browser.hasPointers?"pointerup MSPointerUp":"click",function(r){r.preventDefault&&(r.preventDefault(),r.stopPropagation()),e.event&&(e.event.returnValue=m,e.event.cancelBubble=m),n.isFunction(n.m_Options.onStart())&&n.m_Options.onStart(this),n.m_CurrentTargetElements=n.m_Elements,n.m_CurrentTargetElementsLength=n.m_Elements.length,n.m_CurrentTargetNumber=t,n.openImage(n.m_Elements[n.m_CurrentTargetNumber])})}(r);if(n.addEvent(e,"resize",function(){n.calculateImagePositionAndSize(n.m_CurrentImageElement,!0)}),n.leftAnimationFunction=function(){n.m_CurrentTargetNumber-1<0?(n.openImage(n.m_CurrentTargetElements[n.m_CurrentTargetElementsLength-1],"left"),n.m_CurrentTargetNumber=n.m_CurrentTargetElementsLength-1):(n.openImage(n.m_CurrentTargetElements[n.m_CurrentTargetNumber-1],"left"),n.m_CurrentTargetNumber=n.m_CurrentTargetNumber-1)},n.rightAnimationFunction=function(){n.m_CurrentTargetNumber+1>n.m_CurrentTargetElementsLength-1?(n.openImage(n.m_CurrentTargetElements[0],"right"),n.m_CurrentTargetNumber=0):(n.openImage(n.m_CurrentTargetElements[n.m_CurrentTargetNumber+1],"right"),n.m_CurrentTargetNumber=n.m_CurrentTargetNumber+1)},n.m_Options.enableKeyboard){var a={left:37,right:39,esc:27};n.addEvent(e,"keydown",function(t){if(n.m_CurrentImageElement&&!n.m_InProgress){if(t.preventDefault&&(t.preventDefault(),t.stopPropagation()),e.event){var t=e.event;e.event.returnValue=m,e.event.cancelBubble=m}var r=t.which||t.keyCode;switch(r){case a.esc:return n.removeImageElement(),m;case a.right:return n.rightAnimationFunction(),m;case a.left:return n.leftAnimationFunction(),m}}})}n.m_Options.quitOnDocumentClick&&n.addEvent(l?i:t,"click",function(t){if(n.m_InProgress)return m;if(t.preventDefault&&t.preventDefault(),e.event)var t=e.event;var r=t.target?t.target:t.srcElement;return r&&r.id!==n.m_Options.imageElementId&&n.m_InstalledImageBox&&!n.m_InProgress?(n.removeImageElement(),m):void 0})},openImage:function(n,r){var a=this,o=t.createDocumentFragment(),s=t.createElement("img"),l=t.getElementById(a.m_Options.imageElementId);if(n&&"a"===n.tagName.toLowerCase()){if(l&&(i.removeChild(l),a.m_CurrentImageElement=m,a.m_InstalledImageBox=m),a.m_Alt=n.firstChild.getAttribute("alt"),a.m_InProgress=!0,a.isFunction(a.m_Options.onImageLoadStart())&&a.m_Options.onImageLoadStart(),"undefined"!=typeof r)switch(r){case"left":r=-1;break;case"right":r=1}if(s.setAttribute("id",a.m_Options.imageElementId),s.setAttribute("src",n.getAttribute("href")),s.setAttribute("alt",a.m_Alt),s.setAttribute("style","position: fixed; cursor: pointer; opacity: 0;"),o.appendChild(s),i.appendChild(o),a.m_CurrentImageElement=t.getElementById(a.m_Options.imageElementId),a.m_CurrentImageElement.style.filter="alpha(opacity=0)",a.browser.isHardwareAccelerated&&("undefined"!=typeof r&&(a.m_CurrentImageElement.style[a.getcss3prop("transform")]="translateX("+r*a.m_Options.fadeInDistance+"px)"),a.m_CurrentImageElement.style[a.getcss3prop("transition")]="all "+a.m_Options.animationSpeed+"ms ease"),a.calculateImagePositionAndSize(a.m_CurrentImageElement,m,r),a.m_Options.quitOnImageClick&&a.addEvent(a.m_CurrentImageElement,"click",function(t){t.preventDefault&&t.preventDefault(),e.event&&(e.event.returnValue=m),a.removeImageElement()}),a.browser.isTouch){var u=-1,g=-1,c=0;a.addEvent(a.m_CurrentImageElement,"touchstart pointerdown MSPointerDown",function(e){e.preventDefault(),u=e.pageX||e.touches[0].pageX}),a.addEvent(a.m_CurrentImageElement,"touchmove pointermove MSPointerMove",function(e){e.preventDefault(),g=e.pageX||e.touches[0].pageX,c=u-g,a.browser.isHardwareAccelerated&&(a.m_CurrentImageElement.style[a.getcss3prop("transition")]="none",a.m_CurrentImageElement.style[a.getcss3prop("transform")]="translateX("+-c+"px)")}),a.addEvent(a.m_CurrentImageElement,"touchend pointerup pointercancel MSPointerUp MSPointerCancel",function(e){e.preventDefault(),Math.abs(c)>75?0>c?a.leftAnimationFunction():a.rightAnimationFunction():a.m_CurrentImageElement.style[a.getcss3prop("transform")]="translateX(0px)"})}}},calculateImagePositionAndSize:function(t,n){var r=this,i=new Image,o=0,s=0,l=0;t&&(r.m_ImageSource=t.getAttribute("src"),r.m_ScreenHeight=e.innerHeight||a.offsetHeight,r.m_ScreenWidth=e.innerWidth||a.offsetWidth,i.onload=function(){var e=this.width,a=this.height;o=e,s=a,l=o/s,Math.floor(r.m_ScreenWidth/l)>r.m_ScreenHeight?(o=r.m_ScreenHeight*l*r.m_Options.imageSize,s=r.m_ScreenHeight*r.m_Options.imageSize):(o=r.m_ScreenWidth*r.m_Options.imageSize,s=r.m_ScreenWidth/l*r.m_Options.imageSize),o>e&&(o=e),s>a&&(s=a),t.style.top=(r.m_ScreenHeight-s)/2+"px",t.style.left=(r.m_ScreenWidth-o)/2+"px",t.style.width=Math.floor(o)+"px",t.style.height=Math.floor(s)+"px",n||setTimeout(function(){if(r.browser.isHardwareAccelerated)t.style.opacity=1,t.style[r.getcss3prop("transform")]="translateX(0px)";else{var e=1;r.animate({delay:16,duration:r.m_Options.animationSpeed,delta:r.linear,step:function(n){t.style.opacity=e*n,t.style.filter="alpha(opacity="+e*n*100+")"}})}r.m_InProgress=m,r.m_InstalledImageBox=!0,r.isFunction(r.m_Options.onImageLoadEnd())&&r.m_Options.onImageLoadEnd(t)},100)},i.src=r.m_ImageSource)},removeImageElement:function(){var e=this;if(e.m_CurrentImageElement){if(e.isFunction(e.m_Options.onEnd())&&e.m_Options.onEnd(),e.m_InProgress&&e.isFunction(e.m_Options.onImageLoadEnd())&&e.m_Options.onImageLoadEnd(p_Element),e.browser.isHardwareAccelerated)e.m_CurrentImageElement.style.opacity=0,e.m_CurrentImageElement.style.transition="opacity 250ms ease";else{var t=0;e.animate({delay:16,duration:250,delta:e.linear,step:function(n){e.m_CurrentImageElement.style.opacity=t*n,e.m_CurrentImageElement.style.filter="alpha(opacity="+t*n*100+")"}})}setTimeout(function(){e.m_CurrentImageElement&&e.m_CurrentImageElement.parentNode.removeChild(e.m_CurrentImageElement),e.m_CurrentImageElement=m,e.m_InstalledImageBox=m},e.browser.isHardwareAccelerated?250:350)}},isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)},addEvent:function(n,r,a){var i,u;if(r=r.split(" "),l)if((!n||n instanceof Array&&!n.length||0===n.length)&&n!==e){if(n&&"undefined"!==n[0])for(i=0;i<n.length;i++)for(u=0;u<r.length;u++)n[i][s](r[u],a,m)}else for(i=0;i<r.length;i++)n[s](r[i],a,m);else for(i=0;i<r.length;i++)if(-1!==r[i].indexOf("keydown"))t[o]("on"+r[i],a);else if((!n||n instanceof Array&&!n.length||0===n.length)&&n!==e){if(n&&"undefined"!==n[0])for(u=0;u<n.length;u++)n[u][o](r[i],a)}else n[o]("on"+r[i],a)},animate:function(e){var t=this,n=new Date,r=setInterval(function(){var a=new Date-n,i=a/e.duration;i>1&&(i=1);var m=e.delta(i);e.step(m),1==i&&(t.m_AnimateDone=!0,clearInterval(r))},e.delay||10)},linear:function(e){return e},getcss3prop:function(e){for(var t=["","-moz-","-webkit-","-o-","-ms-","-khtml-"],n=function(e){return e.replace(/\-([a-z])/gi,function(e,t){return t.toUpperCase()})},r=0;r<t.length;r++){var i=n(t[r]+e);if("Ms"==i.substr(0,2)&&(i="m"+i.substr(1)),i in a.style)return i}return"undefined"}},r.options={imageElementId:"simplbox",fadeInDistance:100,animationSpeed:350,imageSize:.8,quitOnImageClick:!0,quitOnDocumentClick:!0,enableKeyboard:!0,onImageLoadStart:function(){},onImageLoadEnd:function(){},onStart:function(){},onEnd:function(){}},e.SimplBox=r}(window,document);